{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "8acd2738-93b6-4ad7-8c85-c919e5ef5aeb",
   "metadata": {},
   "source": [
    "# Assignment 1 — Descriptive Analysis of District-Level Structural Data (EU 2024)\n",
    "\n",
    "**Group:** Linus Wössner, Alens Laskov, Jingyang Zhao  \n",
    "**Course:** Internet & Database Technology  \n",
    "**Dataset:** Official structural indicators at district level from Statistische Ämter des Bundes und der Länder \n",
    "**File:** `data/ew24_structure_data.xlsx`\n",
    "\n",
    "## Objective\n",
    "Conduct a **thorough descriptive analysis** at the **district** level. We will quantify and visualize key structural patterns (e.g., demographics, labor market, education) and present an interpretable narrative of differences across districts.\n",
    "\n",
    "## Evaluation Criteria (what we optimize for)\n",
    "- **Completeness & executability** of the code (end-to-end, reproducible)\n",
    "- **Efficiency** (avoid unnecessary loops; leverage pandas/numpy)\n",
    "- **Robustness** (handle missingness/edge cases; clear checks)\n",
    "- **Comments & explanations** (state *why*, not only *what*)\n",
    "- **Structure of the notebook** (logical flow)\n",
    "- **Line of argumentation** (coherent story, not a plot dump)\n",
    "\n",
    "## Analysis Roadmap  \n",
    "\n",
    "Our approach is designed to move from *raw data* to a *clear and well-argued descriptive analysis*.  \n",
    "The sequence of steps reflects both best practice in data science and the specific evaluation criteria of Assignment 1 (robustness, structure, and line of argumentation).  \n",
    "\n",
    "1. **Data Understanding (Sanity Checks)**  \n",
    "   - *Rationale:* Before producing any statistics, we must first confirm what the dataset contains. This ensures we do not interpret misleading results caused by hidden issues such as incorrect data types, duplicates, or missing values.  \n",
    "   - *Story:* This step answers the question, *“Do we understand what we are analyzing?”* It builds trust in the dataset as the foundation of all later analysis.  \n",
    "\n",
    "2. **Data Preparation (Ensuring Reliability)**  \n",
    "   - *Rationale:* A dataset may look complete at first sight, but it often hides inconsistencies (percentages stored as text, inconsistent units, uneven missingness). Converting and standardizing variables creates a reliable analytical base.  \n",
    "   - *Story:* This step transforms raw input into a dataset that is both technically usable and substantively meaningful, ensuring our descriptive statistics are valid.  \n",
    "\n",
    "3. **Descriptive Analysis (Statistical Summaries & Visualizations)**  \n",
    "   - *Rationale:* Descriptive statistics quantify the distribution of each variable, while visualizations reveal patterns that tables alone may miss. Both are necessary for a thorough analysis.  \n",
    "   - *Story:* Here we shift from “data quality” to “what the data tells us.” We explore central tendencies, variation, and relationships across districts.  \n",
    "\n",
    "4. **Interpretation of Patterns (Analytical Narrative)**  \n",
    "   - *Rationale:* Numbers and charts only become valuable when interpreted. We highlight the most important structural differences across districts and examine which variables tend to move together.  \n",
    "   - *Story:* This is where descriptive analysis becomes a narrative — we move from *“what the numbers are”* to *“what they mean in context.”*  \n",
    "\n",
    "5. **Limitations & Robustness Checks**  \n",
    "   - *Rationale:* A thorough analysis acknowledges where results may be less reliable (due to missing data, proxies, or extreme values). This critical reflection ensures transparency and aligns with good statistical practice.  \n",
    "   - *Story:* This step protects us from over-claiming and shows that our conclusions are careful and robust, not naive.  \n",
    "\n",
    "6. **Conclusion (Key Takeaways)**  \n",
    "   - *Rationale:* A final synthesis condenses the analysis into a few clear, evidence-based insights. This provides closure and makes our work accessible for readers who may not follow every technical detail.  \n",
    "   - *Story:* The analysis ends with a concise answer to the guiding question: *“What do the structural data tell us about German districts ahead of the 2024 European election?”*  \n",
    "\n",
    "*We refer to the raw dataset in code as `idt_df` — the **Internet & Database Technology DataFrame** (i.e., `data/ew24_structure_data.xlsx`).*"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "50b204ba-d1d9-4196-a990-9960411c3e96",
   "metadata": {},
   "source": [
    "## Step 1 — Data Understanding\n",
    "\n",
    "To ensure that our descriptive analysis is both **robust and interpretable**, we first examine the dataset for structural and quality issues.  \n",
    "As the assignment requires a *thorough descriptive analysis*, this step verifies whether the raw data is suitable for statistical summaries and highlights areas that may require preparation.  \n",
    "\n",
    "The following diagnostics are performed:  \n",
    "1. **Dataset structure** — overall shape and preview of the first rows to confirm that one row corresponds to one district.  \n",
    "2. **Data types** — identification of variable types to detect cases where numeric information may be incorrectly stored as text.  \n",
    "3. **Missingness profile** — counts and percentages of missing values, guiding how to handle incomplete variables later.  \n",
    "4. **Duplicate rows** — detection of repeated records that could bias results.  \n",
    "5. **Potential numeric columns stored as text** — identification of variables with symbols (e.g., “%”, “$”) that may need conversion.  \n",
    "6. **Categorical values** — inspection of unique values in categorical columns to confirm expected categories and detect anomalies.  \n",
    "\n",
    "These checks do not alter the dataset; they provide an **evidence base** for the subsequent data preparation step, where necessary corrections (e.g., type conversion, unit standardization) will be applied.  \n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "3c562021-8b72-4d2d-989a-115bd3d49b3b",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Dataset Shape: (444, 52)\n",
      "\n",
      "First 5 rows:\n",
      "                 Land  District                    Name  Municipalities  \\\n",
      "0  Schleswig-Holstein    1001.0        Flensburg, Stadt             1.0   \n",
      "1  Schleswig-Holstein    1002.0  Kiel, Landeshauptstadt             1.0   \n",
      "2  Schleswig-Holstein    1003.0      Lübeck, Hansestadt             1.0   \n",
      "3  Schleswig-Holstein    1004.0       Neumünster, Stadt             1.0   \n",
      "4  Schleswig-Holstein    1051.0            Dithmarschen           116.0   \n",
      "\n",
      "  Area in km2  Population on 31.12.2022 - Total (in 1000)  \\\n",
      "0        56.7                                        92.6   \n",
      "1       118.7                                       247.7   \n",
      "2       214.2                                       218.1   \n",
      "3        71.7                                        79.5   \n",
      "4      1428.2                                       135.3   \n",
      "\n",
      "   Population on 31.12.2022 - German (in 1000)  \\\n",
      "0                                         75.5   \n",
      "1                                        214.1   \n",
      "2                                        190.8   \n",
      "3                                         68.3   \n",
      "4                                        124.8   \n",
      "\n",
      "   Population on 31.12.2022 - Foreigners (%)  \\\n",
      "0                                       18.5   \n",
      "1                                       13.6   \n",
      "2                                       12.5   \n",
      "3                                       14.2   \n",
      "4                                        7.8   \n",
      "\n",
      "   Population density on 31.12.2022 (inhabitants per km2)  \\\n",
      "0                                             1631.4        \n",
      "1                                             2087.8        \n",
      "2                                             1018.2        \n",
      "3                                             1109.4        \n",
      "4                                               94.7        \n",
      "\n",
      "   Increase (+) or decrease (-) in population in 2022 - Birth balance (per 1000 inhabitants)  \\\n",
      "0                                               -4.2                                           \n",
      "1                                               -2.9                                           \n",
      "2                                               -6.7                                           \n",
      "3                                               -7.1                                           \n",
      "4                                               -7.6                                           \n",
      "\n",
      "   ...  \\\n",
      "0  ...   \n",
      "1  ...   \n",
      "2  ...   \n",
      "3  ...   \n",
      "4  ...   \n",
      "\n",
      "   Social insurance contributions as of 30.06.2023 - Public and private service providers (%)  \\\n",
      "0                                               19.2                                            \n",
      "1                                               25.6                                            \n",
      "2                                               20.7                                            \n",
      "3                                               21.3                                            \n",
      "4                                               11.3                                            \n",
      "\n",
      "   Social insurance contributions as of 30.06.2023 - Other service providers and \"unspecified\" (%)  \\\n",
      "0                                               40.0                                                 \n",
      "1                                               39.8                                                 \n",
      "2                                               32.5                                                 \n",
      "3                                               26.6                                                 \n",
      "4                                               32.3                                                 \n",
      "\n",
      "   Recipients of benefits under SGB II in August 2023 - total (per 1000 inhabitants)  \\\n",
      "0                                              115.1                                   \n",
      "1                                              120.5                                   \n",
      "2                                              104.9                                   \n",
      "3                                              112.0                                   \n",
      "4                                               74.6                                   \n",
      "\n",
      "   Recipients of benefits under SGB II in August 2023 - Non-working individuals in need (%)  \\\n",
      "0                                               25.3                                          \n",
      "1                                               26.1                                          \n",
      "2                                               25.7                                          \n",
      "3                                               26.3                                          \n",
      "4                                               26.9                                          \n",
      "\n",
      "   Recipients of benefits under SGB II in August 2023 - Foreigners (%)  \\\n",
      "0                                               37.9                     \n",
      "1                                               41.0                     \n",
      "2                                               35.9                     \n",
      "3                                               35.6                     \n",
      "4                                               35.2                     \n",
      "\n",
      "   Unemployment rate in October 2023 - Total  \\\n",
      "0                                        7.8   \n",
      "1                                        7.5   \n",
      "2                                        7.6   \n",
      "3                                        8.2   \n",
      "4                                        5.5   \n",
      "\n",
      "   Unemployment rate in October 2023 - Men  \\\n",
      "0                                      8.4   \n",
      "1                                      7.9   \n",
      "2                                      8.1   \n",
      "3                                      8.4   \n",
      "4                                      5.8   \n",
      "\n",
      "   Unemployment rate in October 2023 - Women  \\\n",
      "0                                        7.0   \n",
      "1                                        7.1   \n",
      "2                                        7.1   \n",
      "3                                        8.0   \n",
      "4                                        5.2   \n",
      "\n",
      "   Unemployment rate in October 2023 - 15 to 24 years  \\\n",
      "0                                                6.0    \n",
      "1                                                5.3    \n",
      "2                                                6.6    \n",
      "3                                                8.0    \n",
      "4                                                5.8    \n",
      "\n",
      "   Unemployment rate in October 2023 - 55 to 64 years  \n",
      "0                                                7.5   \n",
      "1                                                7.9   \n",
      "2                                                7.6   \n",
      "3                                                7.6   \n",
      "4                                                5.2   \n",
      "\n",
      "[5 rows x 52 columns]\n",
      "\n",
      "Data Types:\n",
      "Land                                                                                                                                    object\n",
      "District                                                                                                                               float64\n",
      "Name                                                                                                                                    object\n",
      "Municipalities                                                                                                                         float64\n",
      "Area in km2                                                                                                                             object\n",
      "Population on 31.12.2022 - Total (in 1000)                                                                                             float64\n",
      "Population on 31.12.2022 - German (in 1000)                                                                                            float64\n",
      "Population on 31.12.2022 - Foreigners (%)                                                                                              float64\n",
      "Population density on 31.12.2022 (inhabitants per km2)                                                                                 float64\n",
      "Increase (+) or decrease (-) in population in 2022 - Birth balance (per 1000 inhabitants)                                              float64\n",
      "Increase (+) or decrease (-) in population in 2022 - Migration balance (per 1000 inhabitants)                                          float64\n",
      "Age on 31.12.2022 - under 16 years (%)                                                                                                 float64\n",
      "Age on 31.12.2022 - 16-17 years (%)                                                                                                    float64\n",
      "Age on 31.12.2022 - 18-24 years (%)                                                                                                    float64\n",
      "Age on 31.12.2022 - 25-34 years (%)                                                                                                    float64\n",
      "Age on 31.12.2022 - 35-59 years (%)                                                                                                    float64\n",
      "Age on 31.12.2022 - 60-74 years (%)                                                                                                    float64\n",
      "Age on 31.12.2022 - 75 years and over (%)                                                                                              float64\n",
      "Land area by type of actual use on 31.12.2021 - Settlement and traffic (%)                                                             float64\n",
      "Land area by type of actual use on 31.12.2021 - Vegetation and water (%)                                                               float64\n",
      "Completed dwellings in 2021 (per 1000 inhabitants)                                                                                     float64\n",
      "Stock of dwellings on 31.12.2021 - total (per 1000 inhabitants)                                                                        float64\n",
      "Residential space on 31.12.2021 (per dwelling)                                                                                         float64\n",
      "Residential space on 31.12.2021 (per inhabitant)                                                                                       float64\n",
      "Car stock on 01.01.2023 - Total cars (per 1000 inhabitants)                                                                            float64\n",
      "Car stock on 01.01.2023 - Cars with electric or hybrid drive (%)                                                                       float64\n",
      "Business register 2021 - Total companies (per 1000 inhabitants)                                                                        float64\n",
      "Business register 2021 - Craft enterprises (per 1000 inhabitants)                                                                      float64\n",
      "School graduates from vocational schools 2022 (per 1000 inhabitants)                                                                    object\n",
      "School graduates from general education schools 2022 - total excluding external candidates (per 1000 inhabitants)                      float64\n",
      "School graduates from general education schools 2022 - without a secondary school certificate (%)                                      float64\n",
      "School graduates from general education schools 2022 - with a secondary school certificate (%)                                         float64\n",
      "School graduates from general education schools 2022 - with an intermediate school certificate (%)                                     float64\n",
      "School graduates from general education schools 2022 - with general or subject-specific higher education entrance qualification (%)     object\n",
      "Childcare on 01.03.2023 - Children under 3 years old (care rate)                                                                       float64\n",
      "Childcare on 01.03.2023 - Children aged 3 to under 6 years old (care rate)                                                             float64\n",
      "Disposable income of private households in 2021 (EUR per inhabitant)                                                                   float64\n",
      "Gross domestic product in 2021 (EUR per inhabitant)                                                                                    float64\n",
      "Social insurance contributions as of 30.06.2023 - total (per 1000 inhabitants)                                                         float64\n",
      "Social insurance contributions as of 30.06.2023 - Agriculture, forestry, fishing (%)                                                    object\n",
      "Social insurance contributions as of 30.06.2023 - Manufacturing industry (%)                                                            object\n",
      "Social insurance contributions as of 30.06.2023 - Trade, hospitality, transport (%)                                                     object\n",
      "Social insurance contributions as of 30.06.2023 - Public and private service providers (%)                                              object\n",
      "Social insurance contributions as of 30.06.2023 - Other service providers and \"unspecified\" (%)                                        float64\n",
      "Recipients of benefits under SGB II in August 2023 - total (per 1000 inhabitants)                                                      float64\n",
      "Recipients of benefits under SGB II in August 2023 - Non-working individuals in need (%)                                               float64\n",
      "Recipients of benefits under SGB II in August 2023 - Foreigners (%)                                                                    float64\n",
      "Unemployment rate in October 2023 - Total                                                                                              float64\n",
      "Unemployment rate in October 2023 - Men                                                                                                float64\n",
      "Unemployment rate in October 2023 - Women                                                                                              float64\n",
      "Unemployment rate in October 2023 - 15 to 24 years                                                                                     float64\n",
      "Unemployment rate in October 2023 - 55 to 64 years                                                                                     float64\n",
      "dtype: object\n",
      "\n",
      "Missing Values Analysis:\n",
      "                                                    Missing Values  \\\n",
      "Land                                                             3   \n",
      "District                                                         3   \n",
      "Name                                                             3   \n",
      "Municipalities                                                   3   \n",
      "Area in km2                                                      2   \n",
      "Population on 31.12.2022 - Total (in 1000)                       3   \n",
      "Population on 31.12.2022 - German (in 1000)                      3   \n",
      "Population on 31.12.2022 - Foreigners (%)                        3   \n",
      "Population density on 31.12.2022 (inhabitants p...               3   \n",
      "Increase (+) or decrease (-) in population in 2...               3   \n",
      "Increase (+) or decrease (-) in population in 2...               3   \n",
      "Age on 31.12.2022 - under 16 years (%)                           3   \n",
      "Age on 31.12.2022 - 16-17 years (%)                              3   \n",
      "Age on 31.12.2022 - 18-24 years (%)                              3   \n",
      "Age on 31.12.2022 - 25-34 years (%)                              3   \n",
      "Age on 31.12.2022 - 35-59 years (%)                              3   \n",
      "Age on 31.12.2022 - 60-74 years (%)                              3   \n",
      "Age on 31.12.2022 - 75 years and over (%)                        3   \n",
      "Land area by type of actual use on 31.12.2021 -...               3   \n",
      "Land area by type of actual use on 31.12.2021 -...               3   \n",
      "Completed dwellings in 2021 (per 1000 inhabitants)               3   \n",
      "Stock of dwellings on 31.12.2021 - total (per 1...               3   \n",
      "Residential space on 31.12.2021 (per dwelling)                   3   \n",
      "Residential space on 31.12.2021 (per inhabitant)                 3   \n",
      "Car stock on 01.01.2023 - Total cars (per 1000 ...               3   \n",
      "Car stock on 01.01.2023 - Cars with electric or...               3   \n",
      "Business register 2021 - Total companies (per 1...               3   \n",
      "Business register 2021 - Craft enterprises (per...               3   \n",
      "School graduates from vocational schools 2022 (...               3   \n",
      "School graduates from general education schools...               3   \n",
      "School graduates from general education schools...               3   \n",
      "School graduates from general education schools...               3   \n",
      "School graduates from general education schools...               3   \n",
      "School graduates from general education schools...               3   \n",
      "Childcare on 01.03.2023 - Children under 3 year...               3   \n",
      "Childcare on 01.03.2023 - Children aged 3 to un...               3   \n",
      "Disposable income of private households in 2021...               3   \n",
      "Gross domestic product in 2021 (EUR per inhabit...               3   \n",
      "Social insurance contributions as of 30.06.2023...               3   \n",
      "Social insurance contributions as of 30.06.2023...               3   \n",
      "Social insurance contributions as of 30.06.2023...               3   \n",
      "Social insurance contributions as of 30.06.2023...               3   \n",
      "Social insurance contributions as of 30.06.2023...               3   \n",
      "Social insurance contributions as of 30.06.2023...               3   \n",
      "Recipients of benefits under SGB II in August 2...               3   \n",
      "Recipients of benefits under SGB II in August 2...               3   \n",
      "Recipients of benefits under SGB II in August 2...               3   \n",
      "Unemployment rate in October 2023 - Total                        3   \n",
      "Unemployment rate in October 2023 - Men                          3   \n",
      "Unemployment rate in October 2023 - Women                        3   \n",
      "Unemployment rate in October 2023 - 15 to 24 years               3   \n",
      "Unemployment rate in October 2023 - 55 to 64 years               3   \n",
      "\n",
      "                                                    Percentage (%)  \n",
      "Land                                                          0.68  \n",
      "District                                                      0.68  \n",
      "Name                                                          0.68  \n",
      "Municipalities                                                0.68  \n",
      "Area in km2                                                   0.45  \n",
      "Population on 31.12.2022 - Total (in 1000)                    0.68  \n",
      "Population on 31.12.2022 - German (in 1000)                   0.68  \n",
      "Population on 31.12.2022 - Foreigners (%)                     0.68  \n",
      "Population density on 31.12.2022 (inhabitants p...            0.68  \n",
      "Increase (+) or decrease (-) in population in 2...            0.68  \n",
      "Increase (+) or decrease (-) in population in 2...            0.68  \n",
      "Age on 31.12.2022 - under 16 years (%)                        0.68  \n",
      "Age on 31.12.2022 - 16-17 years (%)                           0.68  \n",
      "Age on 31.12.2022 - 18-24 years (%)                           0.68  \n",
      "Age on 31.12.2022 - 25-34 years (%)                           0.68  \n",
      "Age on 31.12.2022 - 35-59 years (%)                           0.68  \n",
      "Age on 31.12.2022 - 60-74 years (%)                           0.68  \n",
      "Age on 31.12.2022 - 75 years and over (%)                     0.68  \n",
      "Land area by type of actual use on 31.12.2021 -...            0.68  \n",
      "Land area by type of actual use on 31.12.2021 -...            0.68  \n",
      "Completed dwellings in 2021 (per 1000 inhabitants)            0.68  \n",
      "Stock of dwellings on 31.12.2021 - total (per 1...            0.68  \n",
      "Residential space on 31.12.2021 (per dwelling)                0.68  \n",
      "Residential space on 31.12.2021 (per inhabitant)              0.68  \n",
      "Car stock on 01.01.2023 - Total cars (per 1000 ...            0.68  \n",
      "Car stock on 01.01.2023 - Cars with electric or...            0.68  \n",
      "Business register 2021 - Total companies (per 1...            0.68  \n",
      "Business register 2021 - Craft enterprises (per...            0.68  \n",
      "School graduates from vocational schools 2022 (...            0.68  \n",
      "School graduates from general education schools...            0.68  \n",
      "School graduates from general education schools...            0.68  \n",
      "School graduates from general education schools...            0.68  \n",
      "School graduates from general education schools...            0.68  \n",
      "School graduates from general education schools...            0.68  \n",
      "Childcare on 01.03.2023 - Children under 3 year...            0.68  \n",
      "Childcare on 01.03.2023 - Children aged 3 to un...            0.68  \n",
      "Disposable income of private households in 2021...            0.68  \n",
      "Gross domestic product in 2021 (EUR per inhabit...            0.68  \n",
      "Social insurance contributions as of 30.06.2023...            0.68  \n",
      "Social insurance contributions as of 30.06.2023...            0.68  \n",
      "Social insurance contributions as of 30.06.2023...            0.68  \n",
      "Social insurance contributions as of 30.06.2023...            0.68  \n",
      "Social insurance contributions as of 30.06.2023...            0.68  \n",
      "Social insurance contributions as of 30.06.2023...            0.68  \n",
      "Recipients of benefits under SGB II in August 2...            0.68  \n",
      "Recipients of benefits under SGB II in August 2...            0.68  \n",
      "Recipients of benefits under SGB II in August 2...            0.68  \n",
      "Unemployment rate in October 2023 - Total                     0.68  \n",
      "Unemployment rate in October 2023 - Men                       0.68  \n",
      "Unemployment rate in October 2023 - Women                     0.68  \n",
      "Unemployment rate in October 2023 - 15 to 24 years            0.68  \n",
      "Unemployment rate in October 2023 - 55 to 64 years            0.68  \n",
      "\n",
      "Number of duplicate rows: 1\n",
      "\n",
      "Potential numeric columns stored as text:\n",
      "['Area in km2', 'School graduates from vocational schools 2022 (per 1000 inhabitants)', 'School graduates from general education schools 2022 - with general or subject-specific higher education entrance qualification (%)', 'Social insurance contributions as of 30.06.2023 - Agriculture, forestry, fishing (%)', 'Social insurance contributions as of 30.06.2023 - Manufacturing industry (%)', 'Social insurance contributions as of 30.06.2023 - Trade, hospitality, transport (%)', 'Social insurance contributions as of 30.06.2023 - Public and private service providers (%)']\n",
      "\n",
      "Unique values in categorical columns:\n",
      "Land: ['Schleswig-Holstein' 'Hamburg' 'Niedersachsen' 'Bremen'\n",
      " 'Nordrhein-Westfalen' 'Hessen' 'Rheinland-Pfalz' 'Baden-Württemberg'\n",
      " 'Bayern' 'Saarland' 'Berlin' 'Brandenburg' 'Mecklenburg-Vorpommern'\n",
      " 'Sachsen' 'Sachsen-Anhalt' 'Thüringen' 'Deutschland' nan]\n",
      "Name: 441 unique values\n",
      "Area in km2: 429 unique values\n",
      "School graduates from vocational schools 2022 (per 1000 inhabitants): 81 unique values\n",
      "School graduates from general education schools 2022 - with general or subject-specific higher education entrance qualification (%): 246 unique values\n",
      "Social insurance contributions as of 30.06.2023 - Agriculture, forestry, fishing (%): 52 unique values\n",
      "Social insurance contributions as of 30.06.2023 - Manufacturing industry (%): 261 unique values\n",
      "Social insurance contributions as of 30.06.2023 - Trade, hospitality, transport (%): 163 unique values\n",
      "Social insurance contributions as of 30.06.2023 - Public and private service providers (%): 188 unique values\n"
     ]
    }
   ],
   "source": [
    "# Import necessary libraries\n",
    "import pandas as pd\n",
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "\n",
    "# Load the dataset\n",
    "file_path = '/Users/linuswossner/Desktop/database/Database-and-Techbology/ew24_structure_data.xlsx'\n",
    "idt_df = pd.read_excel(file_path)\n",
    "\n",
    "# 1. Check basic dataset information\n",
    "print(\"Dataset Shape:\", idt_df.shape)\n",
    "print(\"\\nFirst 5 rows:\")\n",
    "print(idt_df.head())\n",
    "\n",
    "# 2. Check data types to identify potential type issues\n",
    "print(\"\\nData Types:\")\n",
    "print(idt_df.dtypes)\n",
    "\n",
    "# 3. Check for missing values\n",
    "missing_values = idt_df.isnull().sum()\n",
    "missing_percentage = (missing_values / len(idt_df)) * 100\n",
    "missing_info = pd.DataFrame({\n",
    "    'Missing Values': missing_values,\n",
    "    'Percentage (%)': missing_percentage.round(2)\n",
    "})\n",
    "print(\"\\nMissing Values Analysis:\")\n",
    "print(missing_info[missing_info['Missing Values'] > 0])\n",
    "\n",
    "# 4. Check for duplicate rows\n",
    "duplicates = idt_df.duplicated().sum()\n",
    "print(f\"\\nNumber of duplicate rows: {duplicates}\")\n",
    "\n",
    "# 5. Check for numeric columns stored as text\n",
    "# This looks for columns that might contain numbers with symbols like '%', '$'\n",
    "potential_numeric_cols = []\n",
    "for col in idt_df.select_dtypes(include=['object']).columns:\n",
    "    # Check a sample of non-null values\n",
    "    sample = idt_df[col].dropna().head(10)\n",
    "    # Try to identify if values contain digits and special characters\n",
    "    if any(str(val).replace('%', '').replace('$', '').replace(',', '').replace('.', '').isdigit() for val in sample if pd.notna(val)):\n",
    "        potential_numeric_cols.append(col)\n",
    "\n",
    "if potential_numeric_cols:\n",
    "    print(\"\\nPotential numeric columns stored as text:\")\n",
    "    print(potential_numeric_cols)\n",
    "\n",
    "# 6. Check for unusual values in categorical columns\n",
    "cat_cols = idt_df.select_dtypes(include=['object', 'category']).columns\n",
    "if len(cat_cols) > 0:\n",
    "    print(\"\\nUnique values in categorical columns:\")\n",
    "    for col in cat_cols:\n",
    "        unique_count = idt_df[col].nunique()\n",
    "        if unique_count < 20:  # Only show if reasonable number of unique values\n",
    "            print(f\"{col}: {idt_df[col].unique()}\")\n",
    "        else:\n",
    "            print(f\"{col}: {unique_count} unique values\")"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python [conda env:internetdatabase] *",
   "language": "python",
   "name": "conda-env-internetdatabase-py"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.18"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
